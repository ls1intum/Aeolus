{
  "api": {
    "title": "API Version",
    "description": "The API version of the windfile.",
    "type": "string",
    "examples": [
      "v0.0.1"
    ]
  },
  "metadata": {
    "title": "Metadata",
    "description": "Metadata of the windfile.",
    "type": "object",
    "allowAdditionalProperties": false,
    "properties": {
      "name": {
        "description": "The name of the windfile.",
        "type": "string",
        "examples": [
          "rust-exercise-jobs"
        ]
      },
      "description": {
        "description": "Description of what this list of actions is supposed to achieve",
        "type": "string",
        "examples": [
          "This windfile contains the jobs that are executed during the CI of the rust-exercise."
        ]
      },
      "author": {
        "description": "The author of the windfile.",
        "$ref": "#/author"
      },
      "targets": {
        "description": "The targets of the windfile.",
        "type": "array",
        "items": {
          "$ref": "#/target"
        }
      }
    },
    "required": [
      "name",
      "description",
      "author"
    ]
  },
  "author": {
    "title": "Author",
    "description": "The author of the windfile.",
    "allowAdditionalProperties": false,
    "oneOf": [
      {
        "type": "string",
        "examples": [
          "Andreas Resch <aeolus@resch.io>"
        ]
      },
      {
        "$ref": "#/contact-data"
      }
    ]
  },
  "contact-data": {
    "type": "object",
    "title": "Contact Data",
    "description": "Contact data of the author.",
    "allowAdditionalProperties": false,
    "properties": {
      "name": {
        "description": "The name of the author.",
        "type": "string",
        "examples": [
          "Andreas Resch"
        ]
      },
      "email": {
        "description": "The email of the author.",
        "type": "string",
        "examples": [
          "aeolus@resch.io"
        ]
      }
    },
    "required": [
      "name"
    ]
  },
  "action": {
    "title": "Action",
    "description": "Action that can be executed.",
    "oneOf": [
      {
        "$ref": "#/file-action"
      },
      {
        "$ref": "#/internal-action"
      },
      {
        "$ref": "#/platform-action"
      },
      {
        "$ref": "#/external-action"
      }
    ]
  },
  "external-action-without-parameters": {
    "title": "External Action without parameters",
    "description": "The name of the external action.",
    "type": "object",
    "additionalProperties": false,
    "properties": {
      "use": {
        "description": "The name of the external action.",
        "title": "Name of the external action.",
        "type": "string"
      },
      "exclude-during": {
        "type": "array",
        "title": "Exclude during",
        "description": "Exclude this action during the specified parts of the lifetime of an exercise.",
        "items": {
          "$ref": "#/lifecycle"
        }
      }
    },
    "required": [
      "use"
    ]
  },
  "platform-action": {
    "title": "Platform Action",
    "description": "Action that is defined for a specific platform.",
    "type": "object",
    "additionalProperties": false,
    "properties": {
      "platform": {
        "description": "The platform that this action is defined for.",
        "$ref": "#/target"
      },
      "file": {
        "description": "The file of the platform action. Written in Python",
        "type": "string"
      },
      "exclude-during": {
        "type": "array",
        "title": "Exclude during",
        "description": "Exclude this action during the specified parts of the lifetime of an exercise.",
        "items": {
          "$ref": "#/lifecycle"
        }
      }
    },
    "required": [
      "platform",
      "file"
    ]
  },
  "file-action": {
    "title": "File Action",
    "description": "Action that is defined in a file.",
    "type": "object",
    "additionalProperties": false,
    "properties": {
      "file": {
        "description": "The file that contains the action.",
        "type": "string"
      },
      "exclude-during": {
        "type": "array",
        "title": "Exclude during",
        "description": "Exclude this action during the specified parts of the lifetime of an exercise.",
        "items": {
          "$ref": "#/lifecycle"
        }
      }
    }
  },
  "internal-action": {
    "title": "Internal Action",
    "description": "Internally defined action that can be executed.",
    "type": "object",
    "additionalProperties": false,
    "properties": {
      "script": {
        "description": "The script of the internal action. Written in aeolus DSL",
        "type": "string"
      },
      "exclude-during": {
        "type": "array",
        "title": "Exclude during",
        "description": "Exclude this action during the specified parts of the lifetime of an exercise.",
        "items": {
          "$ref": "#/lifecycle"
        }
      }
    },
    "required": [
      "script"
    ]
  },
  "external-action": {
    "title": "External Action",
    "description": "External action that can be executed without parameters or with parameters.",
    "oneOf": [
      {
        "$ref": "#/external-action-without-parameters"
      },
      {
        "$ref": "#/external-action-with-parameters"
      }
    ]
  },
  "external-action-with-parameters": {
    "title": "External Action with parameters",
    "description": "External action that needs parameters to be executed.",
    "type": "object",
    "additionalProperties": false,
    "properties": {
      "use": {
        "description": "The name of the external action.",
        "title": "Name of the external action.",
        "type": "string"
      },
      "parameters": {
        "description": "The parameters of the external action.",
        "title": "Parameters of the external action.",
        "$ref": "#/list_or_dict"
      },
      "exclude-during": {
        "type": "array",
        "title": "Exclude during",
        "description": "Exclude this action during the specified parts of the lifetime of an exercise.",
        "items": {
          "$ref": "#/lifecycle"
        }
      }
    },
    "required": [
      "use",
      "parameters"
    ]
  },
  "list_or_dict": {
    "title": "List or Dictionary",
    "oneOf": [
      {
        "type": "object",
        "title": "Dictionary"
      },
      {
        "type": "array",
        "title": "List",
        "items": {
          "type": "string"
        },
        "uniqueItems": true
      }
    ]
  },
  "lifecycle": {
    "title": "Lifecycle",
    "description": "Defines a part of the lifecycle of a job.",
    "type": "string",
    "enum": [
      "preparation",
      "working_time",
      "post_deadline",
      "evaluation",
      "always"
    ],
    "examples": [
      "preparation"
    ]
  },
  "target": {
    "title": "Targets",
    "description": "The CI platforms that are able to run this windfile.",
    "type": "string",
    "enum": [
      "cli",
      "jenkins",
      "bamboo"
    ],
    "examples": [
      "jenkins"
    ]
  }
}